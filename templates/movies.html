{% extends "layout.html" %} {% block content %}

<!-- MOVIE SEARCH -->
<div class="row">
  <div class="col-sm-4">
    <form class="form-inline search">
      <label>Search Movies</label>
      <input
        type="text"
        class="form-control movie-input"
        name="q"
        placeholder="search movies"
      />
      <input
        type="hidden"
        name="api_key"
        value="bcd90145aa0a9afa766db2577135dbf4"
      />
      <input type="submit" value="Go!" class="btn btn-primary" />
    </form>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-sm-2">
        <div class="movie-gallery"></div>
      </div>
    </div>
  </div>
</div>

{% for item in list %}
<div class="card" data-id={{ item.movie_id }} style="width: 18rem;">
  <div class="image-wrapper"></div>
</div>
{% endfor %}

<!-- END SEARCH -->

<!-- START MOVIE GALLERY-->

<section id="gallery" class="py-5">
  <div class="container-fluid">
    <h1 class="text-center">Movies</h1>
    <p class="text-center">Check out our movies</p>
    <div class="row mb-4">
      <div class='row'>
      <div class="col now-playing"></div>
      </div>
    </div>
  </div>
</section>

<!-- <div class="row mb-4">
      <div class="col-sm-2 upcoming"></div>
    </div>
    <div class="row mb-4">
      <div class="col-sm-2 popular"></div>
    </div>
    <div class="row mb-4">
      <div class="col-sm-2 top-rated"></div>
    </div>
 -->

<!-- NEWSLETTER -->
<section id="newsletter" class="text-center p-5 bg-dark text-white">
  <div class="container">
    <div class="row">
      <div class="col">
        <h1>Sign Up For Our Newsletter</h1>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio
          asperiores consectetur, quae ducimus voluptates vero repellendus
          architecto maiores recusandae mollitia?
        </p>
        <form class="form-inline justify-content-center">
          <input
            type="text"
            class="form-control mb-2 mr-2"
            placeholder="Enter Name"
          />
          <input
            type="text"
            class="form-control mb-2 mr-2"
            placeholder="Enter Email"
          />
          <button class="btn btn-primary mb-2">Submit</button>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  let key = `bcd90145aa0a9afa766db2577135dbf4`;
  $(document).ready(function(e) {
    // Now Playing Movies AJAX call
    $.ajax({
      method: 'GET',
      url: `https://api.themoviedb.org/3/movie/now_playing?api_key=${key}&language=en-US&page=1`,
      success: function(response) {
        console.log(`Now Playing:`);
        console.log(response);
        response.results.map(child => {
          let movieId = child.id;
          let img = $(`<img class="now-playing-image" />`);
          let btn = $(
            `<input class="now-playing-button" type=submit value="Add" data-id="${movieId}"></input>`
          );
          let url = 'https://image.tmdb.org/t/p/w500' + child.poster_path;
          img.attr('src', url);
          $('.now-playing').append(img, btn);
          return movieId;
        });
      },
      error: function(error) {
        console.log(error);
      }
    });
  });
</script>

{% endblock %}
